<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SnapTube - Página de Entrada</title>
    <link rel="stylesheet" href="styles.css">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
</head>
<body>
    <header>
        <h1>Bienvenido a SnapTube</h1>
        <p>Ingresa el término de búsqueda para encontrar videos o canciones.</p>
    </header>

        <input type="text" id="search-input" placeholder="-Buscar canciones o artistas..." required style="width: 100%; padding-right: 40px;">
    <button type="button" id="voice-btn" style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%); background: none; border: none;">
      <i class="fas fa-microphone" id="mic-icon"></i>
    </button>
  </div>
  <button type="submit">Buscar</button>
</form>

    <script>
        function search() {
            const query = document.getElementById("search-input").value;
            if(query) {
                // Redirige a la página de resultados con el término de búsqueda en la URL
                window.location.href = `results.html?q=${query}`;
            } else {
                alert("Por favor ingresa un término de búsqueda.");
            }
        }
function search() {
    const query = document.getElementById("search-input").value;
    if (query) {
        window.location.href = `results.html?q=${encodeURIComponent(query)}`;
    } else {
        alert("Por favor ingresa un término de búsqueda.");
    }
}
      function reproducirCancion(url) {
      audioPlayer.src = url;
      audioPlayer.style.display = "block";
      audioPlayer.play();
    }

    audioPlayer.addEventListener("ended", () => {
      audioPlayer.style.display = "none";
    });

if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('service-worker.js');
}

  const micIcon = document.getElementById('mic-icon');
  const voiceBtn = document.getElementById('voice-btn');
  let isRecording = false;
  let reconocimiento;

  voiceBtn.onclick = () => {
    if (isRecording) {
      reconocimiento.stop(); // detener si ya estaba grabando
      return;
    }

    reconocimiento = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
    reconocimiento.lang = 'es-ES';
    reconocimiento.interimResults = false;

    reconocimiento.onstart = () => {
      isRecording = true;
      micIcon.classList.remove('fa-microphone');
      micIcon.classList.add('fa-microphone-lines');
    };

    reconocimiento.onresult = (e) => {
      const texto = e.results[0][0].transcript;
      document.getElementById('search-input').value = texto;
      document.getElementById('search-form').dispatchEvent(new Event('submit')); // dispara búsqueda
    };

    reconocimiento.onerror = (e) => {
      alert("Error al reconocer la voz: " + e.error);
    };

    reconocimiento.onend = () => {
      isRecording = false;
      micIcon.classList.remove('fa-microphone-lines');
      micIcon.classList.add('fa-microphone');
    };

    reconocimiento.start();
  };
    </script>
</body>
</html>